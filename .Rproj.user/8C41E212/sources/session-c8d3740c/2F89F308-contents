---
title: Homework 3
subtitle: Data Visualization Basics
date: last-modified
from: markdown+emoji
comments: false

execute: 
  warning: false
  message: false
  fig-width: 9
  fig-height: 7
  fig-align: center
---

```{r}
#| include: false
library(tidyverse)
library(skimr)
library(rmarkdown)
```

# Direction

- Download the Homework 3 Quarto document, `danl-200-hw-03-q.qmd`, by clicking [this link](https://drive.google.com/file/d/1s7pm4yzumOQDKWJudPYUaQRICRbEaem_/view?usp=share_link).

- Provide both your answer to each question in **Homework 3** in the `danl-200-hw-03-q.qmd`.

- Please submit your **Quarto document for Homework 3** to the Brightspace with the name below:

  - `danl-200-hw3-LASTNAME-FIRSTNAME.qmd`\
  ( e.g., `danl-200-hw3-choe-byeonghak.qmd` )

- The due is March 27, 2024, 11:59 P.M.

- Please send an email to Byeong-Hak (`bchoe@geneseo.edu`) if you have any questions or clarifications.

<br><br><br>



# Customer Data with Health Insurance

Read the data file, `custdata_rev.csv`, as the data.frame object with the name, `health_cust`:

```{r}
#| echo: true
library(tidyverse)
library(skimr)

health_cust <- read_csv(
  'https://bcdanl.github.io/data/custdata_rev.csv'
)
```


```{r}
#| echo: false
#| eval: true

rmarkdown::paged_table(health_cust)
```

<br>

## Variable Description for `health_cust`

The following describes the variables  in the `health_cust` data.frame.

- `custid`: ID of customer
- `sex`: Sex
- `is_employed`: Employment status
  - `NA`: Unknown or not applicable
  - `TRUE`: Employed
  - `FALSE`: Unemployed
- `income`: Income (in $)
- `marital_status`: Marital status
- `housing_type`: Housing type
- `recent_move`: 
  - `TRUE`: Recently moved
  - `FALSE`: Not recently moved
- `age`: Age
- `state_of_res`: State of residence
- `gas_usage`: Gas usage
  - `NA`: Unknown or not applicable
  - `001`: Included in rent or condo fee
  - `002`: Included in electricity payment
  - `003`: No charge or gas not used
  - `004`-`999`: $4 to $999 (rounded and top-coded)
- `health_ins`: Health insuarance status
  - `TRUE`: customer with health insuarance 
  - `FALSE`: customer without health insuarance 

<br><br>

## Question 1 
Report summary statistics including a mean value for each logical variable in `health_cust`.

*Answer*:
```{r}
health_cust_sum <- skim(health_cust)
```

<br><br>





## Question 2 
Use `health_cust` data.frame to create a new data.frame, `health_cust2`, in which 
(1) `age` is greater than 0 and less than 100; and
(2) `income` is positive.

*Answer*:
```{r}
health_cust2 <- filter(health_cust,
                       age > 0, age < 100, income > 0)

```

<br><br>





## Question 3
Provide both ggplot code and comments to describe the distribution of `income`.

*Answer*:
```{r}
ggplot(health_cust2, aes(x = log10(income) ) ) +
  geom_histogram()
```

<br><br>





## Question 4
Provide both ggplot code and comments to describe the distribution of `marital_status`.

*Answer*:
```{r}
ggplot(health_cust, aes(x = marital_status)) +
  geom_bar(fill = "blue", color = "black",
            show.legend = F) 
 
  
```

<br><br>





## Question 5
- Suppose you randomly pick one customer's observation from each state in data.frame `health_cust`.

- Use ggplot code to determine (1) the state where a customer is most probable to possess health insurance; and (2) the state where it is least probable for a customer to have health insurance.

*Answer*:
```{r}
ggplot(health_cust, aes(y = state_of_res, fill = health_ins)) +
  geom_bar(position = "fill") 

```

<br><br>





## Question 6
Provide both ggplot code and comments to describe the relationship between `age` and `income`.


*Answer*:
```{r}
ggplot(health_cust2,
       aes(x = age, y = income)) +
  geom_point(alpha = .05, size = .75) +
  geom_smooth() 
ggplot(health_cust3,
      aes(x = age, y = income) )+
  geom_point(alpha = .05, size = .75)+
  geom_smooth()
health_cust3 <- health_cust2 |> 
  filter(income<200000)
```

<br><br>




## Question 7
Provide both ggplot code and comments to describe the relationship between `age` and `health_ins`.

*Answer*:
```{r}
ggplot(health_cust2) + 
  geom_histogram(aes(x = age), bins = 75) +
  facet_wrap(.~health_ins)
```

<br><br>




## Question 8
Provide both ggplot code and comments to describe the relationship between `marital_status` and `health_ins`.

*Answer*:
```{r}
ggplot(health_cust, aes(x = marital_status, fill = health_ins)) +
  geom_bar(position = "fill") 


```

<br><br>





## Question 9
Provide both ggplot code and comments to describe the relationship between `marital_status` and `housing_type`.

*Answer*:
```{r}
ggplot(health_cust, aes(x = marital_status, fill = housing_type)) +
  geom_bar(position = "fill") 


```

<br><br>



